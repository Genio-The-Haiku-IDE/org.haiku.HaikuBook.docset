<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=9"/>
	<meta name="generator" content="Doxygen 1.12.0"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>The Haiku Book: BBlockCache Class Reference</title>
	<link href="tabs.css" rel="stylesheet" type="text/css"/>
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="dynsections.js"></script>
	<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
	<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
	<link href="doxygen.css" rel="stylesheet" type="text/css" />
	<link href="book.css" rel="stylesheet" type="text/css"/>
	</head>
<body>
	<div id="banner">
		<div class="logo">
			<span class="subtitle">
				API Documentation
			</span>
		</div>
	</div>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classBBlockCache-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">BBlockCache Class Reference<div class="ingroups"><a class="el" href="group__support.html">Support Kit</a> &#124; <a class="el" href="group__libbe.html">(libbe.so)</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>A class that creates and maintains a pool of memory blocks.  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a03b66b65aaabf96bf08eca5f0e46f945" id="r_a03b66b65aaabf96bf08eca5f0e46f945"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03b66b65aaabf96bf08eca5f0e46f945">BBlockCache</a> (<a class="el" href="SupportDefs_8h.html#a9a72138d173e1e5243078b8644d4a1c2">uint32</a> blockCount, size_t blockSize, <a class="el" href="SupportDefs_8h.html#a9a72138d173e1e5243078b8644d4a1c2">uint32</a> allocationType)</td></tr>
<tr class="memdesc:a03b66b65aaabf96bf08eca5f0e46f945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new memory pool.  <br /></td></tr>
<tr class="separator:a03b66b65aaabf96bf08eca5f0e46f945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26c9e9a7af87f71dc45a6133ff4dd8a0" id="r_a26c9e9a7af87f71dc45a6133ff4dd8a0"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26c9e9a7af87f71dc45a6133ff4dd8a0">~BBlockCache</a> ()</td></tr>
<tr class="memdesc:a26c9e9a7af87f71dc45a6133ff4dd8a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the empty blocks in the free list.  <br /></td></tr>
<tr class="separator:a26c9e9a7af87f71dc45a6133ff4dd8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3029dc7884e862338e0b20dfdf77f18" id="r_ad3029dc7884e862338e0b20dfdf77f18"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3029dc7884e862338e0b20dfdf77f18">Get</a> (size_t blockSize)</td></tr>
<tr class="memdesc:ad3029dc7884e862338e0b20dfdf77f18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a block from the pool of free blocks.  <br /></td></tr>
<tr class="separator:ad3029dc7884e862338e0b20dfdf77f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4b1d9199fcd8107b08f9b8b736921c" id="r_a9a4b1d9199fcd8107b08f9b8b736921c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a4b1d9199fcd8107b08f9b8b736921c">Save</a> (void *pointer, size_t blockSize)</td></tr>
<tr class="memdesc:a9a4b1d9199fcd8107b08f9b8b736921c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a block of memory to the memory pool.  <br /></td></tr>
<tr class="separator:a9a4b1d9199fcd8107b08f9b8b736921c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class that creates and maintains a pool of memory blocks. </p>
<p>In some performance critical code there might come a time where you require a lot of little blocks of memory that you want to access and dispose of continuously. Since allocating and freeing memory are 'expensive' operations, it is better to have a pool of memory blocks at your disposal. Luckily, the Haiku API provides a class that will act as the administrator of your memory pool, so you will not have to reinvent the wheel every time.</p>
<p>The principle is easy. The constructor takes the number of blocks you want to create beforehand, the size of the blocks, and the method of allocation. This can either be <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a0fe701514e0415bd5d251d4defd62918" title="Used in the constructor of BBlockCache. Determines that objects will be created using new[] and delet...">B_OBJECT_CACHE</a> or <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a45f0bea7828ddccaabdec213274219a0" title="Used in the constructor of BBlockCache. Determines that objects will be created using malloc() and fr...">B_MALLOC_CACHE</a>. The first one uses C++ operators <code>new</code>[] and <code>delete</code>[], while the second one uses <code>malloc()</code> and <code>free()</code>. Unless you have specific demands on performance or you want to take care of freeing the objects yourself, either way works fine.</p>
<p>As soon as you have the memory pool, you can <a class="el" href="#ad3029dc7884e862338e0b20dfdf77f18" title="Get a block from the pool of free blocks.">Get()</a> blocks. If the pre-allocated memory blocks run out, <a class="el" href="classBBlockCache.html" title="A class that creates and maintains a pool of memory blocks.">BBlockCache</a> will allocate new ones, so you will not have to worry about availability. As soon as you are done you can <a class="el" href="#a9a4b1d9199fcd8107b08f9b8b736921c" title="Save a block of memory to the memory pool.">Save()</a> the memory back into the pool. <a class="el" href="classBBlockCache.html" title="A class that creates and maintains a pool of memory blocks.">BBlockCache</a> will make sure that no more blocks will be saved than the initial number you requested when you created the object, so be aware of that.</p>
<p>As soon as you got a pointer from the <a class="el" href="#ad3029dc7884e862338e0b20dfdf77f18" title="Get a block from the pool of free blocks.">Get()</a> method, you own that block of memory; this means that you have the liberty to dispose of it yourself. It also means that when you delete your <a class="el" href="classBBlockCache.html" title="A class that creates and maintains a pool of memory blocks.">BBlockCache</a> instance, any blocks of memory that are checked out will not be destroyed. In case you might want to delete your objects yourself, make sure you free the memory the right way. If you created the object as <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a0fe701514e0415bd5d251d4defd62918" title="Used in the constructor of BBlockCache. Determines that objects will be created using new[] and delet...">B_OBJECT_CACHE</a>, use <code>delete</code>[] to free your object. If you created the object as <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a45f0bea7828ddccaabdec213274219a0" title="Used in the constructor of BBlockCache. Determines that objects will be created using malloc() and fr...">B_MALLOC_CACHE</a>, use <code>free()</code>. Please note that it defeats the purpose of this class if your are going to free all the objects yourself since it basically means that when the pool runs out, <a class="el" href="#ad3029dc7884e862338e0b20dfdf77f18" title="Get a block from the pool of free blocks.">Get()</a> will be allocating the objects by itself.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classBBlockCache.html" title="A class that creates and maintains a pool of memory blocks.">BBlockCache</a> is thread-safe.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>BeOS R3 </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a03b66b65aaabf96bf08eca5f0e46f945" name="a03b66b65aaabf96bf08eca5f0e46f945"></a>
<h2 class="memtitle"><span class="permalink"><a name="//apple_ref/cpp/Method/BBlockCache" class="dashAnchor">&nbsp;</a><a href="#a03b66b65aaabf96bf08eca5f0e46f945">&#9670;&#160;</a></span>BBlockCache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BBlockCache::BBlockCache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SupportDefs_8h.html#a9a72138d173e1e5243078b8644d4a1c2">uint32</a></td>          <td class="paramname"><span class="paramname"><em>blockCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>blockSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="SupportDefs_8h.html#a9a72138d173e1e5243078b8644d4a1c2">uint32</a></td>          <td class="paramname"><span class="paramname"><em>allocationType</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new memory pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blockCount</td><td>The number of free memory blocks you want to allocate initially. This number is also used as the maximum number of free blocks that will be kept. </td></tr>
    <tr><td class="paramname">blockSize</td><td>The size of the blocks. </td></tr>
    <tr><td class="paramname">allocationType</td><td>Either <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a0fe701514e0415bd5d251d4defd62918" title="Used in the constructor of BBlockCache. Determines that objects will be created using new[] and delet...">B_OBJECT_CACHE</a> for using <code>new</code>[] and <code>delete</code>[] or <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a45f0bea7828ddccaabdec213274219a0" title="Used in the constructor of BBlockCache. Determines that objects will be created using malloc() and fr...">B_MALLOC_CACHE</a> for <code>malloc()</code> and <code>free()</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>BeOS R3 </dd></dl>

</div>
</div>
<a id="a26c9e9a7af87f71dc45a6133ff4dd8a0" name="a26c9e9a7af87f71dc45a6133ff4dd8a0"></a>
<h2 class="memtitle"><span class="permalink"><a name="//apple_ref/cpp/Method/~BBlockCache" class="dashAnchor">&nbsp;</a><a href="#a26c9e9a7af87f71dc45a6133ff4dd8a0">&#9670;&#160;</a></span>~BBlockCache()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual BBlockCache::~BBlockCache </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy the empty blocks in the free list. </p>
<p>Note that the blocks you checked out with <a class="el" href="#ad3029dc7884e862338e0b20dfdf77f18" title="Get a block from the pool of free blocks.">Get()</a> and not checked back in with <a class="el" href="#a9a4b1d9199fcd8107b08f9b8b736921c" title="Save a block of memory to the memory pool.">Save()</a> will not be freed, since ownership belongs to you. Make sure you clean up after yourself.</p>
<dl class="section since"><dt>Since</dt><dd>BeOS R3 </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad3029dc7884e862338e0b20dfdf77f18" name="ad3029dc7884e862338e0b20dfdf77f18"></a>
<h2 class="memtitle"><span class="permalink"><a name="//apple_ref/cpp/Method/Get" class="dashAnchor">&nbsp;</a><a href="#ad3029dc7884e862338e0b20dfdf77f18">&#9670;&#160;</a></span>Get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * BBlockCache::Get </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>blockSize</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a block from the pool of free blocks. </p>
<p>If the pool runs out of free blocks, a new one will be allocated. Please note that if the size given in the <code>blockSize</code> parameter is different from the size given in the constructor, a new block of memory will be created. Only sizes that match the blocks in the memory pool will come from the pool.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blockSize</td><td>The required size of the memory block.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to a memory block, or <code>NULL</code> if locking the object failed.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>BeOS R3 </dd></dl>

</div>
</div>
<a id="a9a4b1d9199fcd8107b08f9b8b736921c" name="a9a4b1d9199fcd8107b08f9b8b736921c"></a>
<h2 class="memtitle"><span class="permalink"><a name="//apple_ref/cpp/Method/Save" class="dashAnchor">&nbsp;</a><a href="#a9a4b1d9199fcd8107b08f9b8b736921c">&#9670;&#160;</a></span>Save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BBlockCache::Save </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pointer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>blockSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a block of memory to the memory pool. </p>
<p>The block of memory will only be added to the pool if the <code>blockSize</code> is equal to the size the object was created with and if the maximum number of free blocks in the list will not be exceeded. If not, the memory will be freed.</p>
<p>Note that it is perfectly valid to pass objects other than those you got from <a class="el" href="#ad3029dc7884e862338e0b20dfdf77f18" title="Get a block from the pool of free blocks.">Get()</a>, but please note that the way it was created conforms to the way memory is allocated and freed in this pool. Therefore, only feed blocks that were created with <code>new</code>[] if the allocation type is <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a0fe701514e0415bd5d251d4defd62918" title="Used in the constructor of BBlockCache. Determines that objects will be created using new[] and delet...">B_OBJECT_CACHE</a>. Likewise, you should only use objects allocated with <code>malloc()</code> when the allocation type is <a class="el" href="BlockCache_8h.html#a7495a48740c9d555f7fbcb48246dbd93a45f0bea7828ddccaabdec213274219a0" title="Used in the constructor of BBlockCache. Determines that objects will be created using malloc() and fr...">B_MALLOC_CACHE</a>.</p>
<dl class="section since"><dt>Since</dt><dd>BeOS R3 </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
  <hr class="footer"/><address class="footer"><small>
    The Haiku Book pre-R1 - BBlockCache Class Reference<br />
    Generated on Sat May 24 2025 23:12:17 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.12.0
  </small></address>
</body>
</html>
