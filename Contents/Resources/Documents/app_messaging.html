<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=9"/>
	<meta name="generator" content="Doxygen 1.12.0"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>The Haiku Book: Messaging Foundations</title>
	<link href="tabs.css" rel="stylesheet" type="text/css"/>
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="dynsections.js"></script>
	<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
	<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
	<link href="doxygen.css" rel="stylesheet" type="text/css" />
	<link href="book.css" rel="stylesheet" type="text/css"/>
	</head>
<body>
	<div id="banner">
		<div class="logo">
			<span class="subtitle">
				API Documentation
			</span>
		</div>
	</div>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Messaging Foundations</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>One of the foundations of the Haiku API is the messaging system. This framework is the basis for the efficient multithreaded Haiku applications, because it solves one of the fundamental issues of multithreading: it allows you to easily and securely communicate between threads. The framework allows inter-application messaging as well as intra-application messaging, and it will always use the most effective mechanism for the communication automatically.</p>
<p>This page will introduce you to the subject of messaging. It is meant as a broad overview to the classes, rather than a tutorial. If you are looking for effective messaging techniques or a tutorial on messaging, have a look at the developer section of the Haiku website.</p>
<p><b>Table of contents</b></p><ul>
<li>Overview of the Messaging Classes</li>
<li>Receiving and Handling Messages</li>
<li>Sending messages</li>
</ul>
<h1><a class="anchor" id="app_messaging_overview"></a>
Overview of the Messaging Classes</h1>
<h2><a class="anchor" id="app_messaging_overview_bmessage"></a>
BMessage</h2>
<p>The <a class="el" href="classBMessage.html" title="A container that can be send and received using the Haiku messaging subsystem.">BMessage</a> class is the class that is in the center of all the messenger operations, because it represents a message. A message is nothing more than an object that contains:</p><ul>
<li>The <code>what</code> member, an <code>uint32</code> that determines the type of message. Some constants are defined by the Haiku API, for example B_MOUSE_DOWN or B_QUIT_REQUESTED.</li>
<li>Zero or more data objects. <a class="el" href="classBMessage.html" title="A container that can be send and received using the Haiku messaging subsystem.">BMessage</a> is a powerful data container that keeps track of different sorts of data. <a class="el" href="classBMessage.html" title="A container that can be send and received using the Haiku messaging subsystem.">BMessage</a> provides many convenient Add*() methods, for example <a class="el" href="classBMessage.html#a2976642c2259ebad33704d1b127bae60" title="Convenience method to add a bool to the label name.">BMessage::AddBool()</a>. With the corresponding Find*() method (in this example, <a class="el" href="classBMessage.html#a99405de493bf7e49ce033ef8cac8825b">FindBool() </a>) you can retrieve the data.</li>
</ul>
<p><a class="el" href="classBMessage.html" title="A container that can be send and received using the Haiku messaging subsystem.">BMessage</a> itself is generic, its syntax and semantics are determined by the context. The Haiku API defines several messages and their required data members. Several applications provide a scripting interface with defined message syntax. You can do the same for your application.</p>
<h2><a class="anchor" id="app_messaging_overview_blooper"></a>
BLooper</h2>
<p>Objects of the <a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a> type are objects that run message loops. Every object runs in its own thread. The <a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a> objects continually check for incoming messages. To process the messages, the looper looks for message handlers that handle the messages within the thread's context. Message handling within a looper is synchronous.</p>
<p><a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a> inherits <a class="el" href="classBHandler.html" title="Handles messages that are passed on by a BLooper.">BHandler</a>, the base class for message handling. However, it is possible to chain additional handlers to the object. For example, if you have an application that understands different networking protocols, and you support extensions that understand the base protocol, these extensions can provide handlers that you can chain in your general message parser thread. See AddHandler() and SetPreferredHandler() for information on handlers.</p>
<p>Messages can be posted to the looper by using the object's PostMessage() method. This method puts the message in the <a class="el" href="classBMessageQueue.html" title="A container that maintains a queue of messages.">BMessageQueue</a> of the looper. Since PostMessage() is asynchronous, the message might not be handled immediately. See <a class="el" href="#app_messaging_overview_bmessenger">BMessenger</a> for a synchronous implementation.</p>
<p>Loopers can have a generic filter that discards messages based on user-definable characteristics. The <a class="el" href="classBMessageFilter.html" title="Describes a message filter for BLooper and BHandler.">BMessageFilter</a> class provides the foundation for the qualifying of messages. See AddCommonFilterList() and SetCommonFilterList() for more information.</p>
<p>To get the most out of the functionality of <a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a>, it is usually subclassed to create a self-contained event 'machine'. Most of the time, these subclasses also perform the message handling, which is possible due to the fact that it is also a subclass of <a class="el" href="classBHandler.html" title="Handles messages that are passed on by a BLooper.">BHandler</a>.</p>
<p>In the Haiku API, there are two major classes that inherit <a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a>: the base application class, <a class="el" href="classBApplication.html" title="A container object for an application.">BApplication</a>, and the window class, <a class="el" href="classBWindow.html" title="Window base class.">BWindow</a>. Because they inherit <a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a>, each application and each window has its own message loop. This makes every window quick and responsive. To keep your applications running smoothly, it is advisable to make sure that event handling that requires more processing power, is done within its own <a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a> context. Networking usually qualifies as a candidate for its own thread.</p>
<h2><a class="anchor" id="app_messaging_overview_bhandler"></a>
BHandler</h2>
<p>Objects of the <a class="el" href="classBHandler.html" title="Handles messages that are passed on by a BLooper.">BHandler</a> type are associated to BLoopers. When they are created, they should be passed to the <a class="el" href="classBLooper.html#a484be74814014e3c48c1a16f44e34074" title="Associate a handler to this looper.">BLooper::AddHandler()</a> method of the looper they want to handle messages for. They can then either be set as preferred handlers (by chaining them with <a class="el" href="classBLooper.html#a07c6e5c65354b48465fde2b0b44e22c6" title="Set a preferred handler.">BLooper::SetPreferredHandler()</a>), or they can be added to other BHandlers with the SetNextHandler() method.</p>
<p>The magic of the class happens in the MessageReceived() method. In your subclasses you override this method, to check the incoming <a class="el" href="classBMessage.html" title="A container that can be send and received using the Haiku messaging subsystem.">BMessage</a>. Usually, you check the <code>what</code> member of the message in a switch statement. If your handler cannot handle the object, it will pass the message on to the parent class.</p>
<dl class="section warning"><dt>Warning</dt><dd>Don't forget to actually call the MessageReceived() method of the base class. Failing to do this will mean that the message chain will not completely be followed, which can lead to unhandled messages. There might be some internal system messages that the Haiku API classes handle, and not actually handling these messages could lead to inconsistent internal behavior.</dd></dl>
<h2><a class="anchor" id="app_messaging_overview_bmessenger"></a>
BMessenger</h2>
<p><a class="el" href="classBMessenger.html" title="A class to send messages to a target BLooper or BHandler.">BMessenger</a> objects can send messages to both local and remote targets. For local targets, a <a class="el" href="classBMessenger.html" title="A class to send messages to a target BLooper or BHandler.">BMessenger</a> provides an advantage over directly calling the <a class="el" href="classBLooper.html#a0de6737bfbf8a8b4913adc8c74bb544e" title="Post a message with the command as what identifier to this looper.">BLooper::PostMessage()</a> method: some variants of the <a class="el" href="classBMessenger.html#aebe5aba546fa4a4696988b1bf6028f3c" title="Delivers a BMessage with command what identifier to the messenger&#39;s target. A response may be sent to...">BMessenger::SendMessage()</a> methods allow for synchronous replies. So, the call will actually verify the handling thread processes the message, and reply to the sender.</p>
<p>The other feature of <a class="el" href="classBMessenger.html" title="A class to send messages to a target BLooper or BHandler.">BMessenger</a> is that it is able to be constructed with the signature of another application as argument. This allows the messenger to pass messages to other applications. It facilitates inter-application communication.</p>
<h2><a class="anchor" id="app_messaging-overview-other"></a>
Other messaging classes</h2>
<p>There are several convenience classes supplied with the application kit, which can make your life easier in some specific cases.</p>
<ul>
<li><a class="el" href="classBInvoker.html" title="An object that can be &quot;invoked&quot; to send a message to a BHandler.">BInvoker</a> binds together a message and a target. By calling <a class="el" href="classBInvoker.html#a5c7b629fb769289c8149b9f776fb2ac5" title="Sends the message to the invoker&#39;s target.">BInvoker::Invoke()</a>, the message will be sent. This class is inherited by the controls in the interface kit, such as <a class="el" href="classBButton.html" title="A control used to initiate an action.">BButton</a>.</li>
<li>A <a class="el" href="classBMessageRunner.html" title="Provides a mechanism for sending one or more messages to a messenger at a specified interval and rece...">BMessageRunner</a> object will send messages to a specified target with specified intervals in between.</li>
<li><a class="el" href="classBMessageQueue.html" title="A container that maintains a queue of messages.">BMessageQueue</a> is a class that is also internally used by <a class="el" href="classBLooper.html" title="Receive and process messages in a separate thread.">BLooper</a>. It provides a queue of messages, with convenience functions of managing this queue.</li>
<li><a class="el" href="classBMessageFilter.html" title="Describes a message filter for BLooper and BHandler.">BMessageFilter</a> is the base class of the filters. Filters can be applied to BLoopers to filter all incoming messages, or to BHandlers to filter messages that could be handled by that object. The filter object can be subclassed and extended by overriding the <a class="el" href="classBMessageFilter.html#a96246bc88f07fbc2590823aad5503b91">Filter() </a> method.</li>
</ul>
<h1><a class="anchor" id="app-messaging-receiving"></a>
Receiving Messages</h1>
<p>To do...</p>
<h1><a class="anchor" id="app-messaging-sending"></a>
Sending Messages</h1>
<p>To do... </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
  <hr class="footer"/><address class="footer"><small>
    The Haiku Book pre-R1 - Messaging Foundations<br />
    Generated on Sat May 24 2025 23:12:17 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.12.0
  </small></address>
</body>
</html>
